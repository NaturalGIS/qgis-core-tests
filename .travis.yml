sudo: required
addons:
  hosts:
    - boundless-test
services:
    - docker
env:
    - PLUGIN_NAME=boundless-test
before_install:
    - docker pull elpaso/qgis-testing-environment:latest
    - docker tag elpaso/qgis-testing-environment:latest qgis-testing-environment
install:
    - docker run -d --name qgis-testing-environment -v ${TRAVIS_BUILD_DIR}:/tests_directory -e DISPLAY=:99 qgis-testing-environment
    - sleep 10

    # Setup QGIS to avoid modals and install test auth db
    - docker exec -it qgis-testing-environment sh -c "qgis_setup.sh ${PLUGIN_NAME}"

    # Build the plugin
    #- docker exec -it qgis-testing-environment sh -c "pip install paver"
    #- docker exec -it qgis-testing-environment sh -c "cd /tests_directory && paver setup"
    - docker exec -it qgis-testing-environment sh -c "ln -s /tests_directory/${PLUGIN_NAME} /root/.qgis2/python/plugins/${PLUGIN_NAME}"

script:
    # Run the unit tests
    # This plugin has not yet any unit tests
    - docker exec -it qgis-testing-environment sh -c "echo '${PLUGIN_NAME} has no unit tests yet, please create them and add here'"
notifications:
  slack:
    secure: ApMhim4dMcIieh+uDARyv0wqufyg0z+ROnzGnzQ2ecQTAB5h/NOVrBy4ZJC0oVjtFlGwfKft/bvrjWKcEWmpBoirHrSjNPMGoGMNQPmtrnZR6mze35Y1wa5RYOH4v5Dp9OIcLFoh+JfSsMciV63qOYXtQXqLY/XGcNJjiPkr2CHcGjItz6GER6nrxV2+n0gIH2nQlybfm57yPQyojwArx/ZTPbnVL5uXSl4pXYSdd1omhWjB+wVfNV0EF+AMFnDbm2ppr2BvVHWGrphIpFX75ZbcN5mHMOZ3ba/mo1tfrKP9OQQ2AT5SaHab20p7Mx7DFqycddPejZ4sOrWhlC7/WZcD4+Dbl9W7N7sR6pLhvnD8UOSFB477MCOJRJolEd8OtDP2tB3wjDMa7cwr7hnF+WmqjUYpPiqHqSvR/8Ek9tmirooMoZ9c7Stvm4GSVyFVBtF7B4TUNf21j/2RMzWG1y9PO3cRB5mqoHmMdpAPIMjWbQrSs+i/JE9dxjZUJt18yQYFsehxkOC48GlnQBc9uordFDVc/ZW8RJbgyju8iBHKhibYVur2GAqNwvzsbr/YGu5fp+jTAxr0qmrEXlHccth9xFvXHhfHLVZPd1SLqOT7opHhF9LmlbwOJJjfTPSOON3EjmBuUr1qoJhgazO70LcFLEyxiBooXWAf4G/JLyo=
